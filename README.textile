h1. check_log_and_send_email.sh : ログチェック＆メール送信スクリプト　テンプレ

監視エージェントがインストールできない環境において、ログファイルをgrepして特定文字列が有ればメール送信、というようなことをするスクリプトのテンプレートです。

単純にログファイルを特定文字列でgrepして結果を見てメール送信させると、ログファイルに特定文字列が存在する間は例えば一分毎にメールが送信され煩雑であるため、前回grepした結果とのdiffを取得し差分があればメール送信する、という仕様にしています。

sendmailコマンドでメール送信するときにSubjectってどうやって付けるんだっけ？というのを忘れることが多いので、その備忘も兼ねています。

h2. 動作環境

Linux的なOSだったらなんでもOKかと


h2. インストール方法

スクリプトを配置しcronにて一分毎の実行、 >/dev/nul 2>&1 などと設定します。
以下、実行例です。

<pre>
<code>

$ touch  new old logfile #新旧ファイルとログファイルを作成します

$ bash test #実行します
nothing #何も起きません

$ echo hoge >> logfile #ログファイルに監視対象文字列を書き込みます 

$ bash test #実行します
0a1
> hoge
send a email #差分があったのでメール送信されます

$ bash test 
nothing #再度実行しますが、差分が無いので何も起きません


</code>
</pre>


h2. その他

sendmailコマンドが使えない環境の場合は、perlの基本的なパッケージのみで(CPANアクセス無しで）Socket通信のみでメール送信できるようなスクリプト（ネットに落ちてます）を配置してメール送信するといいかもしれません。




h1. diff_dns.sh : 複数のdnsサーバのホスト一覧比較スクリプト　テンプレ

DNSサーバの移行時などに、複数のDNSサーバ同士で完全に同一の設定をされているかどうかを簡単にチェックするスクリプトのテンプレです。


h2. 動作環境

Linux的なOSだったらなんでもOKかと


h2. 使い方

中を見てもらえれば。。


